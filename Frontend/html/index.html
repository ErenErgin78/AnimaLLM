<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duygu Chatbot</title>
    <!-- CSS ModÃ¼lleri (tek tek, cache-busting sunucu tarafÄ±ndan eklenecek) -->
    <link rel="stylesheet" href="/static/css/themes.css">
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/matrix.css">
    <link rel="stylesheet" href="/static/css/nodes.css">
    <link rel="stylesheet" href="/static/css/emoji.css">
    <link rel="stylesheet" href="/static/css/chat.css">
    
    <!-- JavaScript ModÃ¼lleri (sÄ±ra Ã¶nemli!) -->
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/matrix.js"></script>
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/emoji.js"></script>
    <script src="/static/js/lightbox.js"></script>
    <script src="/static/js/chat.js"></script>
    <script src="/static/js/nodes.js"></script>
    <script src="/static/js/history.js"></script>
    <script src="/static/js/app.js" defer></script>
</head>
<body>
    <!-- Matrix rain canvas - arka planda akan karakterler -->
    <canvas id="matrix-canvas"></canvas>

    <!-- SaÄŸ Ã¼st kullanÄ±cÄ± butonlarÄ± -->
    <div class="top-right-actions" id="user-actions">
        <!-- GiriÅŸ yapÄ±lmamÄ±ÅŸsa -->
        <div id="auth-buttons" style="display: none;">
            <a href="/login.html" class="action-btn">GiriÅŸ</a>
            <a href="/register.html" class="action-btn">KayÄ±t</a>
        </div>
        <!-- GiriÅŸ yapÄ±lmÄ±ÅŸsa -->
        <div id="user-info" style="display: none;">
            <span id="user-display" class="user-email"></span>
            <button class="action-btn" onclick="handleLogout()">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
        </div>
    </div>
    
    <!-- Sol alt aksiyon butonlarÄ± -->
    <div class="bottom-left-actions">
        <button class="action-btn" id="settings-toggle-btn" onclick="toggleSettingsPanel()">âš™ï¸ Ayarlar</button>
        <div id="settings-panel" class="settings-panel">
            <button class="action-btn settings-item" onclick="toggleTheme()">ğŸŒ— Tema</button>
            <button class="action-btn settings-item" onclick="toggleMatrix()">ğŸ§ª Matrix</button>
            <button class="action-btn settings-item" onclick="toggleFlowerMode()">ğŸŒ¸ Flower</button>
            <button class="action-btn settings-item" id="workspace-save-btn" onclick="saveWorkspaceState()" style="display: none;" title="SÃ¼rÃ¼klenmiÅŸ node yerleÅŸimini kaydeder">ğŸ’¾ DÃ¼zeni Kaydet</button>
            <button class="action-btn settings-item" id="history-toggle-btn" onclick="toggleChatHistory()" style="display: none;">ğŸ“œ GeÃ§miÅŸ</button>
        </div>
    </div>
    
    <!-- Sohbet GeÃ§miÅŸi Paneli - AÃ§Ä±lÄ±r/KapanÄ±r -->
    <div id="chat-history-panel" class="chat-history-panel hidden">
        <div class="chat-history-header">
            <h3>ğŸ“œ Sohbet GeÃ§miÅŸi</h3>
            <button class="chat-history-close" onclick="toggleChatHistory()">âœ•</button>
        </div>
        <div id="chat-history-content" class="chat-history-content">
            <div class="chat-history-loading">YÃ¼kleniyor...</div>
        </div>
        <div class="chat-history-footer">
            <button class="chat-history-new" onclick="startNewConversation(); toggleChatHistory();">â• Yeni Sohbet</button>
            <button class="chat-history-clear" onclick="clearChatHistory()">ğŸ—‘ï¸ TÃ¼mÃ¼nÃ¼ Temizle</button>
        </div>
    </div>
    
    <!-- SVG wires - node'lar arasÄ± baÄŸlantÄ± Ã§izgileri -->
    <svg id="wires" class="wires"></svg>
    
    <!-- Node sistemi - parent hub'lar -->
    <div id="fn-parent-rag" class="func-node">ğŸ“š RAG</div>
    <div id="fn-parent-api" class="func-node">ğŸ”Œ API</div>
    <div id="fn-parent-plain" class="func-node">ğŸ’¬ Chat</div>
    <div id="fn-parent-stats" class="func-node">ğŸ“Š Ä°statistik</div>
    
    <!-- Node sistemi - API child node'larÄ± (hayvanlar) -->
    <div id="fn-dog_photo" class="func-node">ğŸ¶ dog - photo</div>
    <div id="fn-dog_facts" class="func-node">ğŸ¶ dog - facts</div>
    <div id="fn-cat_photo" class="func-node">ğŸ± cat - photo</div>
    <div id="fn-cat_facts" class="func-node">ğŸ± cat - facts</div>
    <div id="fn-fox_photo" class="func-node">ğŸ¦Š fox - photo</div>
    <div id="fn-duck_photo" class="func-node">ğŸ¦† duck - photo</div>
    
    <!-- Node sistemi - RAG child node'larÄ± (PDF'ler) -->
    <div id="fn-pdf-python" class="func-node">ğŸ± Cat Care</div>
    <div id="fn-pdf-anayasa" class="func-node">ğŸ¦œ Parrot Care</div>
    <div id="fn-pdf-clean" class="func-node">ğŸ° Rabbit Care</div>
    
    <!-- Lightbox - gÃ¶rsel tam ekran gÃ¶sterimi -->
    <div id="lightbox" class="lightbox" onclick="if(event.target===this) closeLightbox()">
        <div class="lightbox-content">
            <button class="lightbox-close" onclick="closeLightbox()">âœ•</button>
            <img id="lightbox-img" src="" alt="image" />
            <a id="lightbox-download" class="lightbox-download" href="#" download>â¤“ Ä°ndir</a>
        </div>
    </div>
    
    <!-- Ana container - chat arayÃ¼zÃ¼ -->
    <div class="container">
        <h1>
            Animal-Emotion Chatbot
        </h1>
        
        <!-- YÃ¼z emoji container'Ä± -->
        <div class="face-container">
            <div id="face-emoji" class="face-emoji">ğŸ™‚</div>
        </div>
        
        <!-- Chat mesaj kutusu -->
        <div id="chat-box" class="chat-box"></div>
        
        <!-- Input alanÄ± -->
        <div class="input-area">
            <input 
                type="text" 
                id="user-input" 
                placeholder="MesajÄ±nÄ±zÄ± yazÄ±n..." 
                onkeypress="handleKeyPress(event)"
            >
            <button id="send-btn" onclick="sendMessage()">GÃ¶nder</button>
        </div>
    </div>
</body>
</html>
